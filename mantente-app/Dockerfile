# Usa la imagen base de Alpine, ligera y r치pida
FROM alpine:3.18

# Define el puerto que PocketBase usar치 internamente
ENV PORT=8080

# Instala certificados SSL para que Fly.io conf칤e en la comunicaci칩n
RUN apk add --no-cache ca-certificates

# Establece el directorio de trabajo
WORKDIR /pb

# ... (l칤neas previas)

# 游뚿 CORRECCI칍N: Usar el binario de Linux (sin .exe)
COPY pocketbase /pb/pocketbase 

RUN chmod +x /pb/pocketbase # Esto ya est치 bien

# ... (l칤nea EXPOSE)

# La l칤nea CMD se mantiene igual (sin .exe), ya que Alpine lo ejecutar치 sin problemas.
#CMD ["/pb/pocketbase", "serve", "--http", "0.0.0.0:8080"]
CMD ["/pb/pocketbase", "admin", "reset", "adrcproducciones@gmail.com", "Epacomoasi!24"]
#CMD ["/pb/pocketbase", "serve", "--dir", "/data/clean-db", "--http", "0.0.0.0:8080"]