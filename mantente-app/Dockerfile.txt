# Usa la imagen base de Alpine, ligera y r치pida
FROM alpine:3.18

# Define el puerto que PocketBase usar치 internamente
ENV PORT=8080

# Instala certificados SSL para que Fly.io conf칤e en la comunicaci칩n
RUN apk add --no-cache ca-certificates

# Establece el directorio de trabajo
WORKDIR /pb

# ... (l칤neas previas)

# 游뚿 CAMBIA ESTA L칈NEA PARA INCLUIR LA EXTENSI칍N .exe
COPY pocketbase.exe /pb/pocketbase
RUN chmod +x /pb/pocketbase # <-- A칌ADE ESTA L칈NEA

# ... (l칤nea EXPOSE)

# La l칤nea CMD se mantiene igual (sin .exe), ya que Alpine lo ejecutar치 sin problemas.
#CMD ["/pb/pocketbase", "serve", "--http", "0.0.0.0:8080"]
CMD ["/pb/pocketbase", "serve", "--dir", "/data/db", "--http", "0.0.0.0:8080"]